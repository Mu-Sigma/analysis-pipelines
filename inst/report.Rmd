---
title: "Analysis results"
subtitle: v`r if (!require(rjson)) {install.packages('rjson', dependencies = T, repos = "http://cloud.r-project.org/");};date=(`r format(Sys.Date(), "%B %d, %Y")`)

output: 
  html_document
   
params:
  input: !r data.frame()
  recipe: !r tibble(
      operation = character(),
      functionName = character(),
      parameters = list()
    )
  output: !r list()

---

## Quick Peek
```{r quick peek,echo=FALSE,warning=FALSE,results='asis'}
library(analysisRecipes)
input <<- params$input
recipe <- params$recipe
output <- params$output

DT::datatable(head(input),options = list(scrollX=T))
```


     



```{r, echo =FALSE,warnings=FALSE,results='asis'}

rowNo <- 1
outputDiagram <- ""



while(1) {

    if(recipe[['operation']][[rowNo]] != recipe[['operation']][[rowNo+1]]){
        knit_expanded <- paste0(
            "\n```{r chunk",rowNo,",results='asis', fig.width = 12, out.width = '100%', echo=FALSE}
            \n\n
            cat('## ",recipe[['heading']][[rowNo]]," \n')
            \n\n
            output[[",rowNo,"]]
            \n```
            \n\n"
        )
        outputDiagram <- paste0(outputDiagram, knit_expanded)
        rowNo <- rowNo + 1

    }
    else
    {
      outputDiagram <- paste0(outputDiagram, "\n`r {\"## ",recipe[['heading']][rowNo]," {.tabset}\"}`\n\n")
      tabNo=1
      while (1){
        knit_expanded <- paste0(
            "\n```{r chunk",rowNo,",results='asis', fig.width = 12, out.width = '100%', echo=FALSE}
            \n\n
            cat('### ",tabNo," \n')
            \n\n
            output[[",rowNo,"]]
            \n```
            \n\n"
        )
        outputDiagram <- paste0(outputDiagram, knit_expanded)
        rowNo <- rowNo + 1
        tabNo <- tabNo + 1
        if(recipe[['operation']][rowNo] != recipe[['operation']][rowNo-1])
          break
      }
    }
  
    if(rowNo > length(output))
      break    

}


```



`r paste(knitr::knit(text = outputDiagram), collapse = '\n')`

